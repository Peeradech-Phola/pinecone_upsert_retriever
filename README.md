---

# Pinecone Upsert Retriever Project 🚀

This project integrates Python with **Pinecone** for efficient data processing, supports exporting results to **Excel**, **CSV**, and **PDF**, and ensures compatibility with **Thai text** through Thai font integration.

## ✨ Features

- Retrieve and export Pinecone data to Excel, CSV, and PDF formats.
- Handle Thai text seamlessly with custom font support.
- Upsert data from PDF documents into Pinecone with normalization.

---

## 🛠 Prerequisites

Before you begin, ensure you have the following:

- **Python**: Version 3.8 or higher.
- **Pip**: Python package manager.
- **Environment Variables**:
  - `PINECONE_API_KEY`: Your Pinecone API key.
  - `PINECONE_INDEX_NAME`: The Pinecone index name.
  - `NAMESPACE`: Namespace to query in Pinecone.
  - `PINECONE_ENVIRONMENT`: The Pinecone environment.

---

## 🚀 Getting Started

### 1. Clone the Repository

```bash
git clone <repository_url>
cd <repository_name>
```

### 2. Install Dependencies

Install all required packages using the `requirements.txt` file:

```bash
pip install -r requirements.txt
```

---

## ⚙️ Configuration

### 1. Set Up Environment Variables

Create a `.env` file in the project root directory with the following content:

```env
PINECONE_API_KEY=your_api_key
PINECONE_INDEX_NAME=your_index_name
NAMESPACE=your_namespace
PINECONE_ENVIRONMENT=your_environment
```

### 2. Add Thai Font File

Place the `THSarabunNew.ttf` font file in the project root directory for Thai text support in PDF exports.

---

## 📖 Usage

### 1. Export Data to Excel and CSV 📊

Run the script to fetch data from Pinecone and export it as `.xlsx` and `.csv` files:

```bash
python retriever_xlsx_csv.py
```

Output files will be saved as `output.xlsx` and `output.csv`.

---

### 2. Export Data to PDF 📄

Generate a PDF file from Pinecone data with Thai font integration:

```bash
python retriever_pdf.py
```

The PDF output will be saved as `output.pdf`.

---

### 3. Upsert PDF Data into Pinecone 📥

Index a PDF document into Pinecone by running:

```bash
python upsert_pdf.py
```

This will extract and normalize Thai text before uploading it to your specified Pinecone index.

---

## 📜 Key Scripts

| Script Name               | Description                                           |
|---------------------------|-------------------------------------------------------|
| `retriever_xlsx_csv.py`   | Fetches Pinecone data and exports it to Excel/CSV.    |
| `retriever_pdf.py`        | Fetches Pinecone data and exports it to a PDF file.   |
| `upsert_pdf.py`           | Reads and indexes a PDF document into Pinecone.       |

---

## 📦 Project Structure

```plaintext
📂 Project Root
├── 📂 PDF
│   ├── retriever_pdf.py    # Script to export data to PDF
│   ├── upsert_pdf.py       # Script to upsert data from a PDF
│   ├── THSarabunNew.ttf    # Thai font file
├── 📂 XLSX_CSV
│   ├── retriever_xlsx_csv.py   # Script to export data to Excel/CSV
├── requirements.txt        # Dependencies file
├── .env                    # Environment variables

```

---

## 📝 License

This project is licensed under the **MIT License**.

generated by a tool `readme-md-generator`:
